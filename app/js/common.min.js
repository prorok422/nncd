"use strict";$(function(){function t(t){$.ajax({url:"http://frontend-test.pingbull.com/pages/stepan.bondarenkoo@gmail.com/comments",cache:!1,type:"GET",data:{count:t,offset:0},success:n})}function n(n){var a=n.map(e);$("#comments").html(a),s(),$("div.user").each(function(){$(".comments-new").data("id")==$(this).attr("id")&&$(this).find(".text__info").removeAttr("disabled")}),$(".delete").on("click",function(){var n,e=$(this).closest(".user").data("id");n=e,$.ajax({url:"http://frontend-test.pingbull.com/pages/stepan.bondarenkoo@gmail.com/comments/"+n,type:"POST",dateType:"json",data:{_method:"DELETE"},success:function(n){t(c)}})}),$(".edit").on("click",function(){var n,e,a,s=$(this).closest(".user").data("id"),i=$(this).closest(".user").find(".form__content").text();n=s,a='\n                <div id="reply-block" class="form__wrapper">\n                <div class="top__info">\n                    <div class="form__reply"><i class="fas fa-share"></i><span></span></div>\n                    <div id="cancel" class="text__info"><i class="fa fa-times"></i><span>Cancel</span></div>\n                </div>\n                 <textarea placeholder="Your  Message" id="comment-reply-message" >'+(e=i)+'</textarea>\n                 <button id="send-comment-button" >Send</button> \n                </div>',$(".user").each(function(){$(this).data("id")==n&&$(this).next(".input__wrapper").html(a)}),e&&$("#send-comment-button").on("click",function(){var a,s;return e=$("#comment-reply-message").val(),a=n,s=e,$.ajax({url:"http://frontend-test.pingbull.com/pages/stepan.bondarenkoo@gmail.com/comments/"+a,type:"POST",dateType:"json",data:{_method:"PUT",content:s},success:function(n){t(c)}}),!1}),document.addEventListener("click",l),$(".form__reply").remove(),$("#cancel").on("click",function(){r()})}),$(".reply").on("click",function(){var t,n=$(this).closest(".user").data("id");t=n,console.log(t),setTimeout(function(){$("#send-comment-button").on("click",function(){var n=$("#comment-reply-message").val();return i(t,n),!1})},200),$(".user").each(function(){$(this).data("id")==t&&(console.log("show input"),$(this).next(".input__wrapper").html('\n                <div id="reply-block" class="form__wrapper">\n                <div class="top__info">\n                    <div class="form__reply"><i class="fas fa-share"></i><span></span></div>\n                    <div id="cancel" class="text__info"><i class="fa fa-times"></i><span>Cancel</span></div>\n                </div>\n                 <textarea placeholder="Your  Message" id="comment-reply-message" ></textarea>\n                 <button id="send-comment-button" >Send</button> \n                </div>'))}),document.addEventListener("click",l),s(),$("#cancel").on("click",function(){r()})}),$.ajax({url:"http://frontend-test.pingbull.com/pages/stepan.bondarenkoo@gmail.com/comments",type:"GET",data:{count:999999999},success:function(t){$(".commentsCounter span").html(t.length),1==t.length&&$(".commentsCounter").html(t.length+" comment")}})}function e(t){return'<div class="parentWrapper">\n                    <div class="user" id="'+t.author.id+'"  data-id="'+t.id+'"> \n                    <div class="avatar"><img src="'+t.author.avatar+'" alt=""></div>\n                    <div class="form__wrapper">\n                    \n                    <div class="form__title">\n                        <div class="form__title-name parent">'+t.author.name+'</div>\n                        <div class="text__info"><i class="far fa-clock"></i>'+o(t.created_at)+'</div>\n                    </div>\n                    <div class="form__content">'+t.content+'</div>\n                      <div class="form__btn">\n                        <button class="text__info edit" disabled><i class="fas fa-edit"></i>Edit</button>\n                        <button class="text__info delete" disabled><i class="fas fa-times"></i>Delete</button>\n                        <button class="text__info reply" ><i class="fas fa-reply"></i>Reply</button>\n                      </div>\n                    </div>\n                  </div>\n                  <div class="input__wrapper clearfix"></div>\n                    <ul>\n                     '+t.children.map(a).join("")+"\n                    </ul>\n                </div>"}function a(t){return'<li class="user" id="'+t.author.id+'" data-id="'+t.id+'"> \n                    <div class="avatar avatar-small"><img src="'+t.author.avatar+'" alt=""></div>\n                    <div class="form__wrapper">\n                        <div class="form__title">\n                            <div class="form__title-name"> '+t.author.name+'</div>\n                            <div class="form__reply"><i class="fas fa-share"></i><span></span></div>\n                            <div class="text__info"><i class="far fa-clock"></i>'+o(t.created_at)+'</div>\n                        </div>\n                        <div class="form__content">'+t.content+"</div>\n                    </div>\n                </li>"}function s(){$(".parentWrapper").each(function(){var t=$(this).find(".form__title-name.parent").text();$(this).find(".form__reply span").text(t)})}function i(n,e){if(console.log(21212112),!e)e=$("#mydata").val();return $.ajax({type:"POST",url:"http://frontend-test.pingbull.com/pages/stepan.bondarenkoo@gmail.com/comments",data:{content:e,parent:n||null}}),$("#mydata").val(""),setTimeout(function(){t(c)},500),!1}function o(t){var n=new Date(t);return n.getFullYear()+"-"+("0"+(n.getMonth()+1)).slice(-2)+"-"+("0"+n.getDate()).slice(-2)+" at "+("0"+n.getHours()).slice(-2)+":"+("0"+n.getMinutes()).slice(-2)}t(5),$("#comment-reply").submit(function(t){i(null,null),t.preventDefault()});var c=5;function l(){$(document).mouseup(function(t){var n=$("#reply-block");n.is(t.target)||0!==n.has(t.target).length||n.remove()})}function r(){$("#reply-block").remove()}$("#loadMore").click(function(n){n.preventDefault(),t(c+=5)})});